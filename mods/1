const SaitoOverlay = require('./../../../../lib/saito/ui/saito-overlay/saito-overlay');
const PostViewTemplate = require('./post-view.template');
const PostViewCommentTemplate = require('./post-view-comment.template');

module.exports = PostView = {

  render(app, mod, sig="") {

    mod.overlay = new SaitoOverlay(app, mod);
    mod.overlay.render(app, mod);
    mod.overlay.attachEvents(app, mod);

    mod.overlay.showOverlay(app, mod, PostViewTemplate(app, mod, sig), function() {});
    for (let i = 0; i < 3; i++) {
      app.browser.addElementToDom(PostViewCommentTemplate(app, mod), "post-view-comments");
    }
  },


  attachEvents(app, mod, sig="") {

    document.querySelector('.post-submit-btn').onclick = (e) => {

      let comment = document.querySelector('.post-create-textarea').innerHTML;

      let newtx = mod.createCommentTransaction(sig, comment);
      app.network.propagateTransaction(newtx);

      newtx.children = 0;
      mod.posts.push(newtx);
      mod.render();
      mod.overlay.hideOverlay();

    }



  },


}

